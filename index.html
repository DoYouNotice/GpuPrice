<!DOCTYPE html>
<html>
<head>
    <title>Graphics Card Data</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $.ajax({
                url: "https://www.tomshardware.com/reviews/gpu-hierarchy,4388.html",
                dataType: "html",
                success: function(response) {
                    var html = $.parseHTML(response);

                    var tableRows = $(html).find('#slice-container-L8SfcAV5o28ayEFjzq6cfX-table-10 > div:nth-child(2) > table:nth-child(1) > tbody:nth-child(3) > tr');

                    var fpsData = {};
                    tableRows.each(function() {
                        var name = $(this).find('td:nth-child(1) > strong:nth-child(1) > a:nth-child(1)').text().trim();
                        var fpsPercentage = $(this).find('td:nth-child(2)').text().trim();
                        var fpsMatch = fpsPercentage.match(/([\d.]+)fps/);
                        var fps = fpsMatch ? parseFloat(fpsMatch[1]) : null;

                        fpsData[name] = fps;
                    });

                    var graphicsCards = {
                        "GeForce RTX 3060 Ti": "GeForce+RTX+fuer+Gaming/RTX+3060+Ti",
                        "GeForce RTX 4090": "GeForce+RTX+fuer+Gaming/RTX+4090"
                        // Add more graphics cards here
                    };

                    var basePriceUrl = "https://www.mindfactory.de/Hardware/Grafikkarten+(VGA)/";
                    var cheapestPrices = {};
                    var costPerFrame = {};

                    function fetchPrice(card, cardUrl) {
                        var url = basePriceUrl + cardUrl + ".html/listing_sort/6";

                        $.ajax({
                            url: "https://www.mindfactory.de/Hardware/Grafikkarten+(VGA)/",
                            dataType: "html",
                            success: function(response) {
                                var priceText = $(response).find("div.p:nth-child(6) > div:nth-child(1) > div:nth-child(9)").text().trim();
                                var price = priceText.replace(/[^\d.,]/g, "").replace(".", "").replace(",", ".");
                                price = price ? parseFloat(price) : null;

                                cheapestPrices[card] = price;
                                costPerFrame[card] = price / (fpsData[card] || 1);

                                displayData();
                            },
                            error: function() {
                                cheapestPrices[card] = null;
                                costPerFrame[card] = null;

                                displayData();
                            }
                        });
                    }

                    function displayData() {
                        var sortedCards = Object.entries(costPerFrame).sort(function(a, b) {
                            return a[1] - b[1];
                        });

                        $("#results").empty();

                        sortedCards.forEach(function(card) {
                            var cardName = card[0];
                            var price = cheapestPrices[cardName];
                            var cost = card[1];
                            var fps = fpsData[cardName] || "N/A";

                            var result = $("<div>").addClass("result");
                            result.append($("<h3>").text(cardName));
                            result.append($("<p>").text("Cheapest price: " + (price ? price.toFixed(2) + " €" : "N/A")));
                            result.append($("<p>").text("Cost per frame: " + (cost ? cost.toFixed(2) + " € per frame" : "N/A")));
                            result.append($("<p>").text("FPS: " + fps + " (Ultra 1080p)"));

                            $("#results").append(result);
                        });
                    }

                    for (var card in graphicsCards) {
                        fetchPrice(card, graphicsCards[card]);
                    }
                },
                error: function() {
                    $("#results").text("No data available");
                }
            });
        });
    </script>
    <style>
        .result {
            margin-bottom: 20px;
            border: 1px solid #ccc;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h1>Graphics Card Data</h1>
    <div id="results"></div>
</body>
</html>
